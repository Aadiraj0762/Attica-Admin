(this["webpackJsonpattica-admin"]=this["webpackJsonpattica-admin"]||[]).push([[48],{116:function(t,e,a){"use strict";var c=a(131),n=a.n(c),s=a(0),r=a(36);e.a=t=>{const[e,a]=Object(s.useState)([]||!1),[c,o]=Object(s.useState)(""),[l,i]=Object(s.useState)(!0),{isUpdate:u,setIsUpdate:d,currentPage:h,category:b,searchText:j,invoice:p,status:m,zone:y,time:O,sortedField:g,source:f,limitData:k,startDate:x,endDate:S}=Object(s.useContext)(r.a);return Object(s.useEffect)((()=>{let e=!1,c=n.a.CancelToken.source();return(async()=>{try{const n=await t({cancelToken:c.token});e||(a(n),o(""),i(!1))}catch(s){e||(o(s.message),n.a.isCancel(s),o(s.message),i(!1),a([]))}})(),d(!1),()=>{e=!0,c.cancel("Cancelled in cleanup")}}),[u,h,b,j,p,m,y,O,g,f,k,x,S]),{data:e,error:c,loading:l}}},1240:function(t,e,a){"use strict";a.r(e);var c=a(0),n=a(35),s=a(89),r=a(260),o=a(116),l=a(210),i=a(1);e.default=()=>{const{data:t}=Object(o.a)(r.a.getAllPurchases),[e,a]=Object(c.useState)([]),[u,d]=Object(c.useState)([]),{t:h}=Object(s.a)();Object(c.useEffect)((()=>{const t=localStorage.getItem("itemStockData");t&&a(JSON.parse(t))}),[]);const b=()=>{const e=new Map;null===t||void 0===t||t.forEach((t=>{t.products.forEach((a=>{const c=a.label,n=e.get(c);var s;n?n.stockcount>parseInt(t.quantity)?e.set(c,{...n,stockcount:n.stockcount- -1*parseInt(t.quantity),lastStock:{quantity:parseInt(t.quantity),vendor:t.title,date:t.createdAt}}):e.set(c,{...n,stockcount:n.stockcount+parseInt(t.quantity),lastStock:{quantity:parseInt(t.quantity),vendor:t.title,date:t.createdAt}}):e.set(c,{category:null===(s=t.category[0])||void 0===s?void 0:s.label,item:a.label,stockcount:parseInt(t.quantity),lastStock:{quantity:parseInt(t.quantity),vendor:t.title,date:t.createdAt}})}))}));const c=Array.from(e,(t=>{let[e,a]=t;return{...a}}));a(c),(t=>{const e=t.map((t=>({item:t.item,stockcount:t.stockcount})));localStorage.setItem("itemStockData",JSON.stringify(e))})(c)};return Object(c.useEffect)((()=>{t&&b()}),[t]),Object(c.useEffect)((()=>{fetch("http://localhost:5055/api/productions/").then((t=>t.json())).then((t=>{const a=new Map;t.forEach((t=>{t.selectedItems.forEach((t=>{if(e.find((e=>e.item===t.item.label))){const e=(a.get(t.item.label)||0)+t.quantity;a.set(t.item.label,e)}}))}));const c=Array.from(a,(t=>{let[a,c]=t;const n=e.find((t=>t.item===a));if(n){const t=Math.max(n.stockcount-c,0);return{item:a,remainingStock:t}}return null})).filter(Boolean);d(c)})).catch((t=>{console.error("Error fetching production data:",t)}))}),[e]),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(l.a,{children:h("Item Stock")}),Object(i.jsx)(n.TableContainer,{className:"mb-8",children:Object(i.jsxs)(n.Table,{children:[Object(i.jsx)(n.TableHeader,{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)(n.TableCell,{children:h("S No")}),Object(i.jsx)(n.TableCell,{children:h("Category")}),Object(i.jsx)(n.TableCell,{children:h("Item")}),Object(i.jsx)(n.TableCell,{children:h("Purchased Stock Count")}),Object(i.jsx)(n.TableCell,{children:h("Remaining Count")}),Object(i.jsx)(n.TableCell,{children:h("Last Stock")})]})}),Object(i.jsx)(n.TableBody,{children:e.map(((t,e)=>{const a=u.find((e=>e.item===t.item)),c=a?a.remainingStock:0;return Object(i.jsxs)(n.TableRow,{children:[Object(i.jsx)(n.TableCell,{children:e+1}),Object(i.jsx)(n.TableCell,{children:t.category}),Object(i.jsx)(n.TableCell,{children:t.item}),Object(i.jsx)(n.TableCell,{children:t.stockcount}),Object(i.jsx)(n.TableCell,{children:c}),Object(i.jsxs)(n.TableCell,{children:["Quantity: ",t.lastStock.quantity,"\xa0\xa0\xa0 Vendor: ",t.lastStock.vendor,"\xa0\xa0\xa0 Date:"," ",t.lastStock.date]})]},e)}))})]})})]})}},210:function(t,e,a){"use strict";a(0);var c=a(1);e.a=t=>{let{children:e}=t;return Object(c.jsx)("h1",{className:"my-6 text-lg font-bold text-gray-700 dark:text-gray-300",children:e})}},260:function(t,e,a){"use strict";var c=a(94);const n={getAllPurchases:async()=>c.a.get("/purchases/purchases"),getPurchasesById:async t=>c.a.get(`/purchases/purchases/${t}`),addPurchases:async t=>c.a.post("purchases/addpurchases",t),updatePurchase:async(t,e)=>c.a.put(`/purchases/purchases/${t}`,e),deletePurchase:async(t,e)=>c.a.delete(`/purchases/purchases/${t}`)};e.a=n},94:function(t,e,a){"use strict";var c=a(131),n=a.n(c),s=a(15),r=a.n(s);const o=n.a.create({baseURL:"https://attica.onrender.com/api/",timeout:5e4,headers:{Accept:"application/json","Content-Type":"application/json"}});o.interceptors.request.use((function(t){let e,a;return r.a.get("adminInfo")&&(e=JSON.parse(r.a.get("adminInfo"))),r.a.get("company")&&(a=r.a.get("company")),{...t,headers:{authorization:e?`Bearer ${e.token}`:null,company:a||null}}}));const l=t=>t.data,i={get:(t,e,a)=>o.get(t,e,a).then(l),post:(t,e)=>o.post(t,e).then(l),put:(t,e,a)=>o.put(t,e,a).then(l),patch:(t,e)=>o.patch(t,e).then(l),delete:(t,e)=>o.delete(t,e).then(l)};e.a=i}}]);
//# sourceMappingURL=48.4ab4548d.chunk.js.map